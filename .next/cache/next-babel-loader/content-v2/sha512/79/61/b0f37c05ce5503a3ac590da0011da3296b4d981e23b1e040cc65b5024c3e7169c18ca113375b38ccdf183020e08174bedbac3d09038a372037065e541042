{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\parth\\\\Videos\\\\Docs\\\\React\\\\Github\\\\fitts-eval\\\\pages\\\\index.js\";\nimport { useState, useEffect } from 'react';\nimport Head from 'next/head';\nconst CONST = {\n  min_dist: 30,\n  size1: 47,\n  size2: 54,\n  size3: 61,\n  rounds: 30\n};\n\nfunction convertToCSV(objArray) {\n  var array = typeof objArray != 'object' ? JSON.parse(objArray) : objArray;\n  var str = Object.keys(array[0]).join(',');\n  str = str + '\\r\\n';\n\n  for (var i = 0; i < array.length; i++) {\n    var line = '';\n\n    for (var index in array[i]) {\n      if (line != '') line += ',';\n      line += array[i][index];\n    }\n\n    str += line + '\\r\\n';\n  }\n\n  return str;\n}\n\nfunction Target({\n  target,\n  radius\n}) {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"target-box\",\n    style: {\n      left: `${target[0] - 2 * radius}px`,\n      top: `${target[1] - 2 * radius}px`,\n      width: `${4 * radius}px`,\n      height: `${4 * radius}px`\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"target-core\",\n      style: {\n        left: `${radius}px`,\n        top: `${radius}px`,\n        width: `${2 * radius}px`,\n        height: `${2 * radius}px`\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 36,\n    columnNumber: 5\n  }, this);\n}\n\nfunction randInt(range) {\n  var min = Math.ceil(range[0]);\n  var max = Math.floor(range[1]);\n  return Math.floor(Math.random() * (max - min) + min);\n}\n\nfunction nextPos(target, bounds, radius, pad) {\n  const min_dist = CONST.min_dist;\n  const x_range = [pad + radius, bounds[0] - pad - radius];\n  const y_range = [pad + radius, bounds[1] - pad - radius];\n  let next = [randInt(x_range), randInt(y_range)];\n\n  while (calcDist(target, next) < min_dist) {\n    next = [randInt(x_range), randInt(y_range)];\n  }\n\n  return next;\n}\n\nfunction calcDist(from, to) {\n  try {\n    var x = parseFloat(from[0]) - parseFloat(to[0]);\n    var y = parseFloat(from[1]) - parseFloat(to[1]);\n    return Math.sqrt(x * x + y * y);\n  } catch {\n    return -1;\n  }\n}\n\nexport default function Home() {\n  const {\n    0: pad,\n    1: setPad\n  } = useState(CONST.size1);\n  const {\n    0: radius,\n    1: setRadius\n  } = useState(CONST.size1);\n  const {\n    0: bounds,\n    1: setBounds\n  } = useState([0, 0]);\n  const {\n    0: target,\n    1: setTarget\n  } = useState([0, 0]);\n  const {\n    0: touch,\n    1: setTouch\n  } = useState([radius, radius]);\n  const {\n    0: next,\n    1: setNext\n  } = useState([radius, radius]);\n  const {\n    0: round,\n    1: setRound\n  } = useState(0);\n  const {\n    0: time,\n    1: setTime\n  } = useState(0);\n  const {\n    0: prevTime,\n    1: setPrevTime\n  } = useState(0);\n  const {\n    0: status,\n    1: setStatus\n  } = useState('wait');\n  const {\n    0: log,\n    1: setLog\n  } = useState([]);\n\n  function handleTouchStart(event) {\n    console.log(event.changedTouches[0].clientX, event.changedTouches[0].clientY);\n    setTouch([event.changedTouches[0].clientX, event.changedTouches[0].clientY]);\n  }\n\n  function init() {\n    setStatus('go');\n    setTime(Date.now());\n    setPrevTime(Date.now());\n    const next = nextPos(target, bounds, radius, pad);\n    setTarget(next);\n  }\n\n  useEffect(() => {\n    setBounds([parseInt(document.getElementById(\"touch-bound\").getBoundingClientRect().width), parseInt(document.getElementById(\"touch-bound\").getBoundingClientRect().height)]);\n    setTarget([radius + pad, radius + pad]);\n  }, []);\n\n  function saveCsv(data) {\n    let csvStr = convertToCSV(data);\n    let csvContent = \"data:text/csv;charset=utf-8,\" + csvStr;\n    var encodedUri = encodeURI(csvContent);\n    var link = document.createElement(\"a\");\n    link.setAttribute(\"href\", encodedUri);\n    link.setAttribute(\"download\", `fitts_${new Date().toISOString()}.csv`);\n    document.body.appendChild(link);\n    link.click();\n  }\n\n  useEffect(async () => {\n    if (status !== 'go') return;\n    const now = Date.now();\n    setLog(log.concat([{\n      'round': round + 1,\n      'target_x': Math.round(target[0]),\n      'target_y': Math.round(target[1]),\n      'touch_x': Math.round(touch[0]),\n      'touch_y': Math.round(touch[1]),\n      's_time': prevTime - time,\n      'e_time': now - time,\n      'duration': now - prevTime,\n      'distance': Math.round(calcDist(touch, target)),\n      'hit': calcDist(touch, target) < 2 * radius\n    }]));\n    await setRound(round + 1);\n    await setPrevTime(now);\n\n    if (calcDist(touch, target) < 2 * radius) {\n      const next = nextPos(target, bounds, radius, pad);\n      setTarget(next);\n    }\n\n    if (log.filter(x => x.hit).length >= CONST.rounds) {\n      setStatus('end');\n    }\n  }, [touch]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: [/*#__PURE__*/_jsxDEV(\"title\", {\n        children: \"Fitts Eval\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        name: \"viewport\",\n        content: \"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, viewport-fit=cover\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        name: \"mobile-web-app-capable\",\n        content: \"yes\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        name: \"apple-mobile-web-app-capable\",\n        content: \"yes\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"touch-bound\",\n      className: \"board\",\n      onTouchStart: e => {\n        handleTouchStart(e);\n      },\n      children: [status === 'wait' ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"startBtn\",\n        onClick: init,\n        children: \"Start\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 28\n      }, this) : '', status === 'wait' ? /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        placeholder: \"target radius\",\n        className: \"inputBox\",\n        onChange: e => setRadius(parseInt(e.target.value))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 28\n      }, this) : '', status === 'wait' ? /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        placeholder: \"target radius\",\n        onChange: e => setRadius(parseInt(e.target.value))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 28\n      }, this) : '', status === 'wait' ? /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        placeholder: \"target radius\",\n        onChange: e => setRadius(parseInt(e.target.value))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 28\n      }, this) : '', /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"canvas\",\n        style: {\n          margin: `${pad}px`\n        },\n        children: /*#__PURE__*/_jsxDEV(\"pre\", {\n          className: \"log-box\",\n          children: JSON.stringify(log.map(x => [x.round, x.dist, x.e_time - x.s_time]), null, 1)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 9\n      }, this), status === 'go' ? /*#__PURE__*/_jsxDEV(Target, {\n        radius: radius,\n        target: target\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 26\n      }, this) : '', status === 'end' ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"startBtn\",\n        onClick: () => saveCsv(log),\n        children: \"Download\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 27\n      }, this) : '']\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}","map":{"version":3,"sources":["C:/Users/parth/Videos/Docs/React/Github/fitts-eval/pages/index.js"],"names":["useState","useEffect","Head","CONST","min_dist","size1","size2","size3","rounds","convertToCSV","objArray","array","JSON","parse","str","Object","keys","join","i","length","line","index","Target","target","radius","left","top","width","height","randInt","range","min","Math","ceil","max","floor","random","nextPos","bounds","pad","x_range","y_range","next","calcDist","from","to","x","parseFloat","y","sqrt","Home","setPad","setRadius","setBounds","setTarget","touch","setTouch","setNext","round","setRound","time","setTime","prevTime","setPrevTime","status","setStatus","log","setLog","handleTouchStart","event","console","changedTouches","clientX","clientY","init","Date","now","parseInt","document","getElementById","getBoundingClientRect","saveCsv","data","csvStr","csvContent","encodedUri","encodeURI","link","createElement","setAttribute","toISOString","body","appendChild","click","concat","filter","hit","e","value","margin","stringify","map","dist","e_time","s_time"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react'\r\nimport Head from 'next/head'\r\n\r\n\r\nconst CONST = {\r\n  min_dist : 30,\r\n  size1 : 47,\r\n  size2 : 54,\r\n  size3 : 61,\r\n  rounds : 30\r\n}\r\n\r\n\r\n\r\n\r\nfunction convertToCSV(objArray) {\r\n  var array = typeof objArray != 'object' ? JSON.parse(objArray) : objArray;\r\n  var str = Object.keys(array[0]).join(',');\r\n  str=str+'\\r\\n';\r\n\r\n  for (var i = 0; i < array.length; i++) {\r\n    var line = '';\r\n    for (var index in array[i]) {\r\n      if (line != '') line += ','\r\n      line += array[i][index];\r\n    }\r\n    str += line + '\\r\\n';\r\n  }\r\n  return str;\r\n}\r\n\r\n\r\nfunction Target({target,radius}) {\r\n\r\n  return(\r\n    <div className=\"target-box\" style={{\r\n      left:`${target[0]-2*radius}px`,\r\n      top:`${target[1]-2*radius}px`,\r\n      width:`${4*radius}px`,\r\n      height:`${4*radius}px`\r\n    }}>\r\n      <div className=\"target-core\" style={{\r\n        left:`${radius}px`,\r\n        top:`${radius}px`,\r\n        width:`${2*radius}px`,\r\n        height:`${2*radius}px`\r\n      }}>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n\r\nfunction randInt(range) {\r\n  var min = Math.ceil(range[0]);\r\n  var max = Math.floor(range[1]);\r\n  return Math.floor(Math.random() * (max - min) + min);\r\n}\r\n\r\n\r\nfunction nextPos(target,bounds,radius,pad){\r\n\r\n  const min_dist = CONST.min_dist;\r\n  const x_range = [pad+radius,bounds[0]-pad-radius]\r\n  const y_range = [pad+radius,bounds[1]-pad-radius]\r\n\r\n  let next = [randInt(x_range),randInt(y_range)]\r\n\r\n  while(calcDist(target,next)<min_dist){\r\n    next = [randInt(x_range),randInt(y_range)]\r\n  }\r\n  return next\r\n}\r\n\r\n\r\nfunction calcDist(from,to){\r\n\r\n  try{\r\n    var x=parseFloat(from[0])-parseFloat(to[0])\r\n    var y=parseFloat(from[1])-parseFloat(to[1])\r\n    return Math.sqrt(x*x + y*y);\r\n  }\r\n  catch{\r\n    return -1\r\n  }\r\n  \r\n}\r\n\r\nexport default function Home() {\r\n\r\n  const [pad,setPad] = useState(CONST.size1)\r\n  const [radius,setRadius] = useState(CONST.size1)\r\n  const [bounds, setBounds] = useState([0,0])\r\n  const [target, setTarget] = useState([0,0])\r\n  const [touch, setTouch] = useState([radius,radius])\r\n  const [next, setNext] = useState([radius,radius])\r\n  \r\n  const [round,setRound] = useState(0)\r\n  const [time, setTime] = useState(0)\r\n  const [prevTime,setPrevTime] = useState(0)\r\n\r\n  const [status,setStatus] = useState('wait')\r\n  const [log,setLog] = useState([])\r\n\r\n\r\n  function handleTouchStart(event){\r\n    console.log(event.changedTouches[0].clientX,event.changedTouches[0].clientY)\r\n    setTouch([event.changedTouches[0].clientX,event.changedTouches[0].clientY])\r\n  }\r\n  \r\n\r\n  function init(){\r\n    setStatus('go')\r\n    setTime(Date.now())\r\n    setPrevTime(Date.now())\r\n    \r\n    const next = nextPos(target,bounds,radius,pad)\r\n    setTarget(next)\r\n  }\r\n\r\n  useEffect(()=>{\r\n    setBounds([\r\n      parseInt(document.getElementById(\"touch-bound\").getBoundingClientRect().width),\r\n      parseInt(document.getElementById(\"touch-bound\").getBoundingClientRect().height)\r\n    ])\r\n    setTarget([radius+pad,radius+pad])\r\n  },[])\r\n\r\n\r\n  function saveCsv(data){\r\n    let csvStr = convertToCSV(data)\r\n    let csvContent = \"data:text/csv;charset=utf-8,\"+csvStr\r\n    var encodedUri = encodeURI(csvContent);\r\n    \r\n    var link = document.createElement(\"a\");\r\n    link.setAttribute(\"href\", encodedUri);\r\n    link.setAttribute(\"download\", `fitts_${(new Date()).toISOString()}.csv`);\r\n    document.body.appendChild(link); \r\n\r\n    link.click();\r\n  }\r\n\r\n  useEffect(async()=>{\r\n    if(status!=='go')return;\r\n    \r\n    const now = Date.now()\r\n    setLog(log.concat([{\r\n      'round': round+1,\r\n      'target_x' : Math.round(target[0]),\r\n      'target_y' : Math.round(target[1]),\r\n      'touch_x' : Math.round(touch[0]),\r\n      'touch_y' : Math.round(touch[1]),\r\n      's_time': prevTime-time,\r\n      'e_time': now-time,\r\n      'duration' : now - prevTime,\r\n      'distance' : Math.round(calcDist(touch,target)),\r\n      'hit' : (calcDist(touch,target)<(2*radius))\r\n    }]))\r\n\r\n    await setRound(round+1)\r\n\r\n    await setPrevTime(now)\r\n\r\n    if(calcDist(touch,target)<2*radius){\r\n      const next = nextPos(target,bounds,radius,pad)\r\n      setTarget(next)\r\n    }\r\n    \r\n    if(log.filter(x=>(x.hit)).length>=CONST.rounds){\r\n      setStatus('end')\r\n    }\r\n      \r\n  },[touch])\r\n\r\n\r\n  return (\r\n    <>\r\n      <Head>\r\n        <title>Fitts Eval</title>\r\n        <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, viewport-fit=cover'/>\r\n        <meta name=\"mobile-web-app-capable\" content=\"yes\"/>\r\n        <meta name=\"apple-mobile-web-app-capable\" content=\"yes\"/>\r\n      </Head>\r\n      \r\n      <div id=\"touch-bound\" className=\"board\" onTouchStart={(e)=>{handleTouchStart(e)}}>\r\n        {(status==='wait')?<div className=\"startBtn\" onClick={init}>Start</div>:''}\r\n        {(status==='wait')?<input type=\"number\" placeholder=\"target radius\" className=\"inputBox\" onChange={e => setRadius(parseInt(e.target.value))}/>:''}\r\n        {(status==='wait')?<input type=\"number\" placeholder=\"target radius\" onChange={e => setRadius(parseInt(e.target.value))}/>:''}\r\n        {(status==='wait')?<input type=\"number\" placeholder=\"target radius\" onChange={e => setRadius(parseInt(e.target.value))}/>:''}\r\n        \r\n        <div className=\"canvas\" style={{margin: `${pad}px`}}>\r\n          <pre className=\"log-box\">\r\n            {JSON.stringify(log.map(x=>[x.round,x.dist,x.e_time-x.s_time]),null,1)}\r\n          </pre>\r\n        </div>\r\n        {(status==='go')?<Target radius={radius} target={target}/>:''}\r\n        {(status==='end')?<div className=\"startBtn\" onClick={()=>saveCsv(log)}>Download</div>:''}\r\n      </div>\r\n    </>\r\n  )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}